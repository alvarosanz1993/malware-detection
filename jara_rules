import os, binascii

doc_magics = ['D0CF11E0', '504B0304', '3C3F786D']
rtf_magics = ['7B5C727466', '7B5C7274']
pdf_magics = ['25504446']
exe_magics = ["4D5A"]
eml_magics = ["5265636569766564", "44656C6976657265"]
msg_magics = ["D0CF11E0A1B11AE1"]

filename = os.path.join(os.path.dirname(os.path.abspath(__file__)), "files", "prueba.eml")
content = open(filename, 'rb').read()

exe_hex_magic = binascii.hexlify(content[:2]).upper().decode('ascii')
hex_magic = binascii.hexlify(content[:4]).upper().decode('ascii')
rtf_hex_magic = binascii.hexlify(content[:5]).upper().decode('ascii')
eml_hex_magic = binascii.hexlify(content[:8]).upper().decode('ascii')
msg_hex_magic = binascii.hexlify(content[:8]).upper().decode('ascii')

if exe_hex_magic in exe_magics:
    print("El fichero {0} es un ejecutable".format(filename.split('\\')[-1]))
elif rtf_hex_magic in rtf_magics:
    print("El fichero {0} es un RTF".format(filename.split('\\')[-1]))
elif hex_magic in doc_magics:
    print("El fichero {0} es un DOC".format(filename.split('\\')[-1]))
elif hex_magic in pdf_magics:
    print("El fichero {0} es un PDF".format(filename.split('\\')[-1]))
elif eml_hex_magic in eml_magics:
    print("El fichero {0} es un EML".format(filename.split('\\')[-1]))
elif msg_hex_magic in msg_magics:
    print("El fichero {0} es un MSG".format(filename.split('\\')[-1]))
